<!-- Content Header (Page header) -->
<section class="content-header">
	<h1>
		我的工作台<small>Control panel</small>
	</h1>
	<ol class="breadcrumb">
		<li><a href="${basePath}/main"><i class="fa fa-dashboard"></i> 首页</a></li>
		<li class="active">我的工作台</li>
	</ol>
</section>
<br/>
<!-- Main content -->
<section class="content">
	<div class="box">
        <div class="box-header">
              <h3 class="box-title">盒型选择</h3>
        </div>
		<div class="box box-primary">

		   <div class="box-body">
	        <form id="picture-form" action="" class="form-horizontal" method="post">
           
			  <div class="row">
	          	<div class="col-sm-3">
	          		<div class="form-group">
						<label class="col-sm-4 control-label">盒型选择：</label>
						<div class="col-sm-8">
							<select name="search-box" id="search-box" class="form-control">
							</select>
						</div>
					</div>
			    </div>
		          <div class="col-sm-3">
		       		<div class="form-group" id="divgroupid0" style="display:none">
						<label class="col-sm-4 control-label" id="detail0"></label>
						<div class="col-sm-8">
							<select name="search-detail0" id="search-detail0" class="form-control">
								</select>
						</div>
					</div>
				</div>
				<div class="col-sm-3">
					<div class="form-group" id="divgroupid1" style="display:none">
						<label class="col-sm-4 control-label" id="detail1"></label>
						<div class="col-sm-8">
							<select name="search-detail1" id="search-detail1" class="form-control">
							</select>
						</div>
					</div>
				</div> 
	           <div class="col-sm-3">
	         	<div class="form-group" id="divgroupid2" style="display:none">
					<label class="col-sm-4 control-label" id="detail2"></label>
					<div class="col-sm-8">
						<select name="search-detail2" id="search-detail2" class="form-control">
						</select>
					</div>
				</div>
	           </div>
			</div>
			<div class="row">
	           <button type="button" data-btn-type="search" class="btn btn-warning"><i class="fa fa-search"></i>查询</button>  
			   <button type="button" data-btn-type="reset" class="btn btn-default"><i class="fa fa-reply"></i>重置</button>
			</div>
 		</form>
		</div>
		<div class="row">
		 <div class="alert alert-warning alert-dismissible" id="alert" style="display:none">
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                <h4><i class="icon fa fa-warning"></i> 提示!</h4>
               		 查询不到任何信息，请重新搜索！
              </div>
        </div>
		<div class="row">	
          <div class="col-xs-6 col-sm-3 col-md-3" id="box0" value="" style="display:none">
			<div class="box-header with-border">
				  <h3 class="box-title" id="boxName0"></h3>
				</div>
				<a href="#a-href0" class="thumbnail" onclick="xiadan(0)">
				<img src="${basePath}/assets/common/images/1.jpg" id="img0" alt="First slide" class="img-thumbnail"> 
		
				</a>
		 </div>
		<div class="col-xs-6 col-sm-3 col-md-3" id="box1" value="" style="display:none">
			<div class="box-header with-border">
			  <h3 class="box-title" id="boxName1"></h3>
			</div>
			<a href="#a-href1" class="thumbnail" onclick="xiadan(1)">
			<img src="${basePath}/assets/common/images/1.jpg" id="img1" alt="First slide" class="img-thumbnail"> 
			</a>
		</div>

		<div class="col-xs-6 col-sm-3 col-md-3" id="box2" value="" style="display:none">
			<div class="box-header with-border">
			  <h3 class="box-title" id="boxName2"></h3>
			</div>
			<a href="#a-href2" class="thumbnail" onclick="xiadan(2)">
			<img src="${basePath}/assets/common/images/1.jpg" id="img2" alt="First slide" class="img-thumbnail"> 
			</a> 
		</div>

		<div class="col-xs-6 col-sm-3 col-md-3" id="box3" value="" style="display:none">
			<div class="box-header with-border">
			  <h3 class="box-title" id="boxName3"></h3>
			</div>
			<a href="#a-href3" class="thumbnail" onclick="xiadan(box3)">
			<img src="${basePath}/assets/common/images/1.jpg" id="img3" alt="First slide" class="img-thumbnail"> 
			</a>
		</div>
      </div>
     </div>
   
		<div class="row">	
         	<div class="col-xs-6 col-sm-3 col-md-3" id="box4" value="" style="display:none">
				<div class="box-header with-border">
					  <h3 class="box-title" id="boxName4"></h3>
					</div>
				<a href="#a-href4" class="thumbnail" onclick="xiadan(box4)">
					<img src="${basePath}/assets/common/images/1.jpg" id="img4" id="img" alt="First slide" class="img-thumbnail"> 
				</a>
		 	</div>

			<div class="col-xs-6 col-sm-3 col-md-3" id="box5" value="" style="display:none">
				<div class="box-header with-border">
				  <h3 class="box-title" id="boxName5"></h3>
				</div>
				<a href="#a-href5" class="thumbnail" value="" onclick="xiadan(box5)">
					<img src="${basePath}/assets/common/images/1.jpg" id="img5" alt="First slide" class="img-thumbnail"> 
				</a>
			</div>

			<div class="col-xs-6 col-sm-3 col-md-3" id="box6" value="" style="display:none">
				<div class="box-header with-border">
				  <h3 class="box-title" id="boxName6"></h3>
				</div>
				<a href="#a-href6" class="thumbnail" onclick="xiadan(box6)">
					<img src="${basePath}/assets/common/images/1.jpg" id="img6" alt="First slide" class="img-thumbnail"> 
				</a>
			</div>

			<div class="col-xs-6 col-sm-3 col-md-3" id="box7" value="" style="display:none">
				<div class="box-header with-border">
				  <h3 class="box-title" id="boxName7"></h3>
				</div>
				<a href="#a-href7" class="thumbnail" onclick="xiadan(box7)">
					<img src="${basePath}/assets/common/images/1.jpg" id="img7" alt="First slide" class="img-thumbnail"> 
				</a>
			</div>

			</div>
			<div class="row">	
         	<div class="col-xs-6 col-sm-3 col-md-3" id="box8" value="" style="display:none">
				<div class="box-header with-border">
					  <h3 class="box-title" id="boxName8"></h3>
					</div>
				<a href="#a-href8" class="thumbnail" onclick="xiadan(box8)">
					<img src="${basePath}/assets/common/images/1.jpg" id="img8" alt="First slide" class="img-thumbnail"> 
				</a>
		 	</div>

			<div class="col-xs-6 col-sm-3 col-md-3" id="box9" value="" style="display:none">
				<div class="box-header with-border">
				  <h3 class="box-title" id="boxName9"></h3>
				</div>
				<a href="#a-href9" class="thumbnail" onclick="xiadan(box9)">
					<img src="${basePath}/assets/common/images/1.jpg" id="img9" alt="First slide" class="img-thumbnail"> 
				</a>
			</div>

			<div class="col-xs-6 col-sm-3 col-md-3" id="box10" value="" style="display:none">
				<div class="box-header with-border">
				  <h3 class="box-title" id="boxName10"></h3>
				</div>
				<a href="#a-href10;" class="thumbnail" onclick="xiadan(box10)">
					<img src="${basePath}/assets/common/images/1.jpg" id="img10" alt="First slide" class="img-thumbnail"> 
				</a>
			</div>

			<div class="col-xs-6 col-sm-3 col-md-3" id="box11" value="" style="display:none">
				<div class="box-header with-border">
				  <h3 class="box-title" id="boxName11"></h3>
				</div>
				<a href="#a-href11" class="thumbnail" onclick="xiadan(box11)">
					<img src="${basePath}/assets/common/images/1.jpg" id="img11" alt="First slide" class="img-thumbnail"> 
				</a>
			</div>

			</div>
     </div>
     </div>
	 <ul class="pagination pagination-right">
<!-- 	    <li><a href="#">&laquo;</a></li>
 -->	    <li><a href="#" class="active" >首页</a></li>
	    <li><a href="#" >下一页</a></li>
	    <li><a href="#" >上一页</a></li>
	    <li><a href="#" >末页</a></li>
     </ul>
	
</section>
<!-- 新增用户的弹窗 -->
<div class="modal fade" id="modal-admin" aria-labelledby="modalAdminLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<form class="form-horizontal" action="" id="picture-form" method="post">
				<input type="hidden" id="flag" name="flag">
				<input type="hidden" id="id" name="id">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"
						aria-hidden="true">×</button>
					<h4 class="modal-title" id="modalAdminLabel"></h4>
				</div>
				<div class="modal-body">
					<div class="form-group">
						<label class="col-sm-4 control-label">用户名<span style="color: red;">*</span></label>
						<div class="col-sm-8">
							<input id="loginName" name="loginName" type="text" class="form-control"
								placeholder="请输入用户名">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-4 control-label">手机号码<span style="color: red;">*</span></label>
						<div class="col-sm-8">
							<input id="phone" name="phone" type="text" class="form-control"
								placeholder="请输入手机号码" maxlength="11">
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-4 control-label">真实姓名<span style="color: red;">*</span></label>
						<div class="col-sm-8">
							<input id="name" name="name" type="text" class="form-control"
								placeholder="请输入真实姓名">
						</div>
					</div>

					<div class="form-group">
						<label class="col-sm-4 control-label">出生日期<span style="color: red;">*</span></label>
						<div class="input-group date col-sm-8">
							<div class="input-group-addon">
	                        	<i class="fa fa-calendar"></i>
	                        </div>
							<input id="birthday" name="birthday" type="text" class="form-control" id="birthday" data-flag="datepicker" data-format="yyyy-MM-dd"
								placeholder="请选择出生日期">

						</div>
					</div>

					<div class="form-group">
						<label class="col-sm-4 control-label">性别<span style="color: red;">*</span></label>
						<div class="col-sm-8">
							<select name="sex" id="sex" class="form-control">
								<option value="">请选择...</option>
								<option value="1">男</option>
								<option value="2">女</option>
							</select>
						</div>
					</div>

					<!-- <div class="form-group">
						<label class="col-sm-4 control-label">用户类别<span style="color: red;">*</span></label>
						<div class="col-sm-8">
							<select name="type" id="type" class="form-control">
								<option value="">请选择...</option>
								<option value="2">后台管理员</option>
								<option value="3">后台业务员</option>
							</select>
						</div>
					</div> -->

					<div class="form-group">
						<label class="col-sm-4 control-label">状态<span style="color: red;">*</span></label>
						<div class="col-sm-8">
							<label class="control-label"> <input type="radio"
								name="status" data-flag="icheck" value="1" checked="checked">
								启用
							</label> &nbsp; <label class="control-label"> <input type="radio"
								name="status" data-flag="icheck" value="0">
								禁用
							</label>
						</div>
					</div>
					
					<div class="modal-footer">
						<button type="submit" class="btn btn-success" id="saveBtn"><i class="fa fa-save"></i>保存</button>
						<button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-close"></i>关闭</button>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>


<script src="${basePath}/assets/adminlte/plugins/bootstrap-table/bootstrap-table.js"></script>
<script src="${basePath}/assets/common/js/base.js"></script>

<!-- 加入页面的的脚本 -->
<script type="text/javascript">
$(function(){
	//查询默认所有列表
	var page=1;
	pictureList(page);
	setBox("search-box");
	$("#alert").hide();
	pictureForm = $("#picture-form").form();
	//userSearchForm = $("#admin-search-form").form();
	//-------------button event begin----------------
	$('button[data-btn-type]').click(function() {
		//var selected = $('#admin-table').bootstrapTable('getSelections');
		var action = $(this).attr('data-btn-type');
		switch (action) {
		
		case 'search':
			//var formParams = $("#picture-form").serializeJSON();
			var classid = $("#search-box option:selected").val();
			var detail0 = $("#search-detail0 option:selected").val();
			var detail1 = $("#search-detail1 option:selected").val();
			var detail2 = $("#search-detail2 option:selected").val();
			var params={"search-box":classid,"search-detail0":detail0,"search-detail1":detail1,
					"search-detail2":detail2,"page":page}
			console.log(JSON.stringify(params));
			ajaxPost(basePath + "/web/pictureList", {
				params:JSON.stringify(params)
				
			}, function(data) {
				console.log(JSON.stringify(data));
				if(data==null||data.length==0){
					$("#alert").show();
					for(var i=0;i<11;i++){
						$("#box"+i).hide();
					}
					}else{
						$("#alert").hide();
						for(var i=0, len = data.length;i<len;i++){
							$("#box"+i).show();
							$("#box"+i).val(data[i].boxId);
							$("#boxName"+i).html(data[i].name);
							var imgUrl="http://139.199.159.121:8080/images/BoxType/"+data[i].boxId+"/plan/"+data[i].plan;
							console.log(imgUrl);
							$("#img"+i).attr("src",imgUrl);
							/* $("#img"+i).attr("src",data[i].pla); */
							}
						}
			});	
			break;
		case 'reset':
			pictureForm.clearForm();
			//重置按钮重新加载页面
		    pictureList(page);
			break;
	}

	});
	//-------------button event end----------------
	
	//-------------Validator from begin----------------
	//查询表单box下拉改变事件
	$("#search-box").change(function(){
		 var boxId=$("#search-box").val();
		 $("#divgroupid0").hide();
		 $("#divgroupid1").hide();
		 $("#divgroupid2").hide();
		
		$("#search-detail0").empty();
		$("#search-detail1").empty();  
		$("#search-detail2").empty(); 
		setBoxType(boxId); 
	});
	//-------------Validator from end----------------
	
});
/**
 * 默认查询所有列表
 */
 function pictureList(page){
	 
	 var params={"page":page}
	//查询全部图表列表
		ajaxPost(basePath + "/web/pictureList", {
			params:JSON.stringify(params)
			}, function(data) {
				console.log(JSON.stringify(data));
				if(data==null||data.length==0){
					$("#alert").show();
					for(var i=0;i<11;i++){
						$("#box"+i).hide();
					}
					}else{
						$("#alert").hide();
			for(var i=0, len = data.length;i<len;i++){
				$("#box"+i).show();
				$("#box"+i).val(data[i].boxId);
				$("#boxName"+i).text(data[i].name);
				var imgUrl = "http://139.199.159.121:8080/images/BoxType/"
				+data[i].boxId+"/plan/"+data[i].plan;
				$("#img"+i).attr("src",imgUrl);
				//$("#img"+i).attr("src",data[i].pla);
				}
					}	
				});	
	 }
/**
 * 设置纸盒选择下拉类型
 * @param selectid
 * @param 
 * @returns
 */
function setBox(selectid){
	ajaxPost(basePath+"/web/boxTree", null, function(data) {
		console.log("查询下拉列表"+JSON.stringify(data));
		var $select = $('#'+selectid);  
		$select.empty();
		if(data.length==0){
			 $select.val("");
		}
		if(data.length>0){
			 $select.append('<option value="">请选择...</option>'); 
		}
		for(var i=0,len = data.length;i<len;i++){
			var c=data[i]; 
		 	var cid=c.id
		 	var ctext=c.text;
		   	$select.append('<option value="'+cid+'">'+ctext+'</option>'); 
				
		} 
	});
}
/**
 * 根据纸盒类型
 */
function setBoxType(boxId){
	//alert(JSON.stringify(universityId));
	ajaxPost(basePath+"/web/boxTree", null, function(data) {
		
		$('#search-detail0').empty();
		$('#search-detail1').empty();
		$('#search-detail2').empty();
		
		for(var i=0,len = data.length;i<len;i++){
			var c=data[i]; 
			 var a = c.nodes;
			   if(c.id==boxId){
				   console.log(JSON.stringify(a));
				   
				   for(var j=0,len = a.length;j<len;j++){
					   if(a.length==0){
						   $("#search-detail"+j).val("");
						
						}
						if(a.length>0){
							$("#search-detail"+j).append('<option value="">请选择...</option>'); 
						}
					   var d=a[j]; 
					   var dtext=d.text;
					   $("#divgroupid"+j).show();
					   $("#detail"+j).text(dtext);
					   if(d.nodes!=null&&d.nodes.length>0){
						   console.log(JSON.stringify(d.nodes));
						   var e = d.nodes;
						   for(var k=0,len = e.length;k<len;k++){
							   var f=e[k];
							   var fid=f.id;
							   var ftext=f.text;
							   $("#search-detail"+j).append('<option value="'+fid+'">'+ftext+'</option>');
							}
					 
						}
						  
					   }
					}
				} 
	});
}

	function resetForm(){
		userForm.clearForm();
		
	}
	
	/*
	 * 得到所有选中行
	 */
	function xiadan(n) {
		var boxId = $("#box"+n).val();
		var params={"boxId":boxId}
		console.log(boxId);
		var boxid = sessionStorage.setItem("boxId",boxId);
		 loadPage(basePath+"/web/xiadan");
	}
	/**
	 * tab页面加载
	 * @param tabsId
	 * @param url
	 * @returns
	 */
	function showTabs(tabsId,url) {
	    $("a[href='#"+tabsId+"']").tab('show');
	    var $tabContent = $('#'+tabsId);
	    if($tabContent.length < 100) {
	        $tabContent.load(url);
	    }
	}
</script>